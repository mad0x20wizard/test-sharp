name: Update Homebrew tap

on:
  push:
    tags: ["v*"]

jobs:
  bump-tap:
    runs-on: ubuntu-latest
    
    # Building macOS bottles is expensive, so we only update the Homebrew formula for stable releases.
    if: ${{ ! (contains(github.ref_name, '-alpha') || contains(github.ref_name, '-beta')) }}
    
    steps:
      - name: Update Homebrew formula
        uses: dawidd6/action-homebrew-bump-formula@v7
        with:
          token: ${{ secrets.TAP_PAT }}
          tap: mad0x20wizard/homebrew-test
          formula: test-sharp
          no_fork: true